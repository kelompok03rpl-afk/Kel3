<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SIBHD - Sistem Informasi Barang Hilang & Ditemukan</title>
  <meta name="description" content="Aplikasi demo SIBHD - laporan barang hilang & ditemukan" />
  <style>
  :root {
    --bg:#0b0720;
    --card:#0f0b1a;
    --muted:#98a1c3;
    --accent1:#6b21a8;
    --accent2:#0ea5e9;
    --glass:rgba(255,255,255,0.04);
    --glass-2:rgba(255,255,255,0.02);
    --success:#10b981;
    --danger:#ef4444;
    --radius:12px;
    --shadow:0 8px 30px rgba(2,6,23,0.6);
    font-family: Inter, system-ui, -apple-system, 'Segoe UI', Roboto, Arial;
  }

  * {box-sizing:border-box;margin:0;padding:0}
  html,body {
    height:100%;
    background:linear-gradient(180deg,var(--bg),#071023);
    color:#e6eef8;
    overflow-x:hidden; /* cegah overflow horizontal */
  }
  a{color:inherit}

  .wrap{max-width:1200px;margin:28px auto;padding:20px}
  header{display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap}
  .brand{display:flex;align-items:center;gap:14px}
  .logo{width:56px;height:56px;border-radius:14px;background:linear-gradient(135deg,var(--accent1),var(--accent2));display:flex;align-items:center;justify-content:center;color:#fff;font-weight:800;font-size:20px;box-shadow:0 6px 20px rgba(99,102,241,0.12)}
  h1{font-size:20px}
  p.lead{color:var(--muted);font-size:13px}

  .controls{display:flex;gap:12px;align-items:center}
  .btn{background:linear-gradient(90deg,var(--accent1),var(--accent2));border:0;padding:10px 14px;border-radius:10px;color:#fff;font-weight:700;cursor:pointer;box-shadow:0 8px 20px rgba(14,165,233,0.12)}
  .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted);padding:8px 12px}
  .btn.warn{background:linear-gradient(90deg,#c084fc,#60a5fa);}

  .grid{
    display:grid;
    grid-template-columns:1fr 380px;
    gap:20px;
    margin-top:18px;
  }
  @media (max-width:980px){.grid{grid-template-columns:1fr}}

  /* --- perbaikan utama --- */
  .card{
    background:linear-gradient(180deg,var(--card),#090510);
    border-radius:var(--radius);
    padding:18px;
    border:1px solid var(--glass);
    box-shadow:var(--shadow);
    width:100%;
    max-width:100%;
    box-sizing:border-box;
    overflow-wrap:break-word; /* cegah teks panjang keluar */
  }
  .section{
    margin:20px auto;
    padding:15px;
    max-width:900px;
    box-sizing:border-box;
    overflow:hidden;
  }

  .card h2{font-size:16px;margin-bottom:8px}
  .muted{color:var(--muted);font-size:13px}

  label{display:block;font-size:13px;margin-bottom:6px;color:var(--muted)}
  input[type="text"],select,textarea,input[type="file"]{
    width:100%;
    padding:10px;
    border-radius:10px;
    background:transparent;
    border:1px solid rgba(255,255,255,0.06);
    color:#e6eef8;
  }
  textarea{min-height:110px;resize:vertical}

  .row{display:flex;gap:10px;margin-bottom:12px;flex-wrap:wrap}
  .row .col{flex:1}

  .form-actions{display:flex;gap:10px;align-items:center;margin-top:12px;flex-wrap:wrap}

  .gallery{display:grid;grid-template-columns:repeat(2,1fr);gap:14px}
  @media (max-width:680px){.gallery{grid-template-columns:1fr}}
  .item{display:flex;gap:12px;border-radius:12px;overflow:hidden;border:1px solid rgba(255,255,255,0.03);background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);padding:10px;align-items:center;transition:all .18s}
  .thumb{width:110px;height:82px;border-radius:8px;object-fit:cover;background:#111}
  .meta{flex:1;min-width:0}
  .meta h3{font-size:15px;margin-bottom:6px;overflow-wrap:break-word}
  .meta .small{font-size:13px;color:var(--muted)}
  .tiny{font-size:12px;color:var(--muted)}

  .status{display:inline-block;padding:6px 10px;border-radius:999px;font-size:13px;background:var(--glass-2);color:var(--muted)}
  .status.found{background:linear-gradient(90deg,#052e11,rgba(16,185,129,0.12));color:var(--success)}
  .status.lost{background:linear-gradient(90deg,#3b0711,rgba(239,68,68,0.08));color:var(--danger)}

  .meta .row-actions{display:flex;gap:8px;margin-top:8px;flex-wrap:wrap}
  .id-badge{font-size:11px;padding:6px 8px;border-radius:8px;background:rgba(255,255,255,0.02);color:var(--muted);display:inline-block}

  footer{text-align:center;margin-top:18px;color:var(--muted);font-size:13px}

  /* modal custom */
  .overlay{position:fixed;inset:0;background:linear-gradient(180deg,rgba(2,6,23,0.6),rgba(2,6,23,0.8));display:none;align-items:center;justify-content:center;padding:20px}
  .overlay.show{display:flex}
  .modal{width:100%;max-width:520px;background:linear-gradient(180deg,#0b0814,#0f0b18);border-radius:12px;padding:18px;border:1px solid rgba(255,255,255,0.04)}
  .modal h3{margin-bottom:6px}
  .modal .muted{margin-bottom:12px}
  .modal .fields{display:grid;gap:10px}

  /* hover effects */
  .item:hover{transform:translateY(-4px)}
  .btn:active{transform:translateY(1px)}

  /* responsif kecil */
  @media (max-width:520px){
    header{flex-direction:column;align-items:flex-start}
    .controls{width:100%;justify-content:space-between}
    .gallery{grid-template-columns:1fr}
    .grid{gap:12px}
  }
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo">S</div>
        <div>
          <h1>SIBHD</h1>
          <p class="lead">Sistem Informasi Barang Hilang &amp; Ditemukan</p>
        </div>
      </div>
      <div class="controls">
        <button class="btn ghost" id="openAdmin">Masuk Admin</button>
        <button class="btn warn" id="btnReset">Hapus Data Demo</button>
      </div>
    </header>

    <main class="grid">
      <section>
        <div class="card">
          <h2>Laporkan Barang</h2>
          <p class="muted">Isi formulir untuk laporan barang hilang atau ditemukan. Semua teks berbahasa Indonesia.</p>

          <form id="reportForm">
            <div class="row">
              <div class="col">
                <label for="type">Tipe Laporan</label>
                <select id="type" required>
                  <option value="">-- Pilih tipe --</option>
                  <option value="temuan">Barang Ditemukan</option>
                  <option value="hilang">Barang Hilang</option>
                </select>
              </div>
              <div class="col">
                <label for="category">Kategori</label>
                <input id="category" type="text" placeholder="Contoh: Dompet, Kunci, HP" />
              </div>
            </div>

            <label for="title">Judul singkat</label>
            <input id="title" type="text" placeholder="Misal: Dompet warna hitam" required />

            <label for="description">Deskripsi</label>
            <textarea id="description" placeholder="Deskripsikan barang dan ciri khas (mis. merek, nomor, tanda)"></textarea>

            <div class="row">
              <div class="col">
                <label for="location">Lokasi</label>
                <input id="location" type="text" placeholder="Lokasi ditemukan atau terakhir dilihat" />
              </div>
              <div class="col">
                <label for="contact">Kontak (opsional)</label>
                <input id="contact" type="text" placeholder="Nama / No. HP / Email" />
              </div>
            </div>

            <label for="photo">Foto (maks 2MB)</label>
            <input id="photo" type="file" accept="image/*" />
            <p class="tiny muted">Foto akan membantu proses verifikasi. (Opsional)</p>

            <div class="form-actions">
              <button type="submit" class="btn">Kirim Laporan</button>
              <button type="button" class="btn ghost" id="clearForm">Bersihkan</button>
              <div style="margin-left:auto" class="tiny muted">Jumlah laporan: <span id="statsCount">0</span></div>
            </div>
          </form>
        </div>

        <div class="card" style="margin-top:16px">
          <h2>Galeri Barang</h2>
          <p class="muted">Gunakan kotak pencarian atau filter untuk menemukan laporan.</p>

          <div style="display:flex;gap:10px;margin:12px 0">
            <input id="search" type="text" placeholder="Cari judul, kategori, lokasi..." style="flex:1;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:#e6eef8" />
            <select id="filterType" style="padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:#e6eef8">
              <option value="all">Semua</option>
              <option value="temuan">Ditemukan</option>
              <option value="hilang">Hilang</option>
            </select>
          </div>

          <div id="gallery" class="gallery"></div>
        </div>
      </section>

      <aside>
        <div class="card">
          <h2>Informasi</h2>
          <p class="muted">Panduan singkat:</p>
          <ul style="margin-top:8px;line-height:1.6;color:var(--muted)">
            <li>Isi formulir dengan informasi yang jelas dan kontak yang dapat dihubungi.</li>
            <li>Admin akan memverifikasi laporan dan menandai status.</li>
            <li>Serah terima barang dilakukan secara tatap muka di lokasi yang disepakati.</li>
          </ul>
        </div>

        <div class="card" style="margin-top:14px">
          <h2>Aturan Unggah</h2>
          <p class="muted tiny">- Maks file: 2MB • Format: JPG/PNG • Deskripsi sejelas mungkin.</p>
        </div>

        <div class="card" style="margin-top:14px">
          <h2>Panel Admin (Demo)</h2>
          <p class="muted tiny">Masuk sebagai admin untuk mengubah status laporan.</p>
          <div style="display:flex;gap:8px;margin-top:8px">
            <button class="btn ghost" id="openAdmin2">Masuk Admin</button>
            <button class="btn" id="listIds">Tampilkan ID</button>
          </div>
        </div>
      </aside>
    </main>

    <footer>
      <p>© SIBHD Demo • KELOMPOK 3</p>
    </footer>
  </div>

  <!-- overlay modal -->
  <div id="overlay" class="overlay">
    <div class="modal card">
      <h3>Masuk Admin</h3>
      <p class="muted">Masukkan kata sandi admin untuk mengakses panel (demo: <strong>admin</strong>).</p>
      <div class="fields">
        <input id="adminPass" type="password" placeholder="Kata sandi admin" />
        <div style="display:flex;gap:8px;justify-content:flex-end">
          <button class="btn ghost" id="closeOverlay">Batal</button>
          <button class="btn" id="loginAdmin">Masuk</button>
        </div>
        <p id="adminMsg" class="tiny muted"></p>
      </div>
    </div>
  </div>

  <script>
    const STORAGE_KEY = 'sibhd_reports_v2'
    const form = document.getElementById('reportForm')
    const gallery = document.getElementById('gallery')
    const statsCount = document.getElementById('statsCount')
    const search = document.getElementById('search')
    const filterType = document.getElementById('filterType')

    function loadReports(){
      const r = localStorage.getItem(STORAGE_KEY)
      return r ? JSON.parse(r) : []
    }
    function saveReports(list){
      localStorage.setItem(STORAGE_KEY, JSON.stringify(list))
      renderGallery()
    }
    function uid(){return Date.now().toString(36)+Math.random().toString(36).slice(2,6)}
    async function fileToDataURL(file){
      return new Promise((res,rej)=>{
        const fr=new FileReader()
        fr.onload = ()=>res(fr.result)
        fr.onerror = ()=>rej('error')
        fr.readAsDataURL(file)
      })
    }

    function escapeHtml(s){return String(s||'').replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;')}

    function renderGallery(){
      const list = loadReports()
      const q = (search.value||'').trim().toLowerCase()
      const filter = filterType.value
      statsCount.textContent = list.length
      const filtered = list.filter(r=>{
        if(filter!=='all' && r.type!==filter) return false
        if(!q) return true
        return (r.title||'').toLowerCase().includes(q) || (r.location||'').toLowerCase().includes(q) || (r.category||'').toLowerCase().includes(q)
      })

      gallery.innerHTML = filtered.map(r=>`
        <div class="item" data-id="${r.id}">
          <img class="thumb" src="${r.photo||'data:image/svg+xml;utf8,<svg xmlns=\'http://www.w3.org/2000/svg\' width=\'200\' height=\'120\'><rect width=\'100%\' height=\'100%\' fill=\'%230b0b10\'></rect></svg>'}" alt="thumb">
          <div class="meta">
            <h3>${escapeHtml(r.title||'—')}</h3>
            <div class="small tiny">${escapeHtml(r.category||'-')} • ${escapeHtml(r.location||'-')}</div>
            <div style="margin-top:6px;color:var(--muted);font-size:13px">${escapeHtml((r.description||'').slice(0,140))}${(r.description||'').length>140? '...':''}</div>
            <div class="row-actions">
              <span class="id-badge">ID: ${r.id}</span>
              <span class="status ${r.type==='temuan'?'found':'lost'}">${r.type==='temuan'?'Ditemukan':'Hilang'}</span>
              <button class="btn ghost" onclick="viewDetail('${r.id}')">Detail / Klaim</button>
            </div>
          </div>
        </div>
      `).join('')
    }

    function viewDetail(id){
      const list = loadReports()
      const item = list.find(x=>x.id===id)
      if(!item) return alert('Laporan tidak ditemukan')
      const info = `Judul: ${item.title}\nTipe: ${item.type}\nKategori: ${item.category || '-'}\nLokasi: ${item.location || '-'}\nDeskripsi: ${item.description || '-'}\nKontak: ${item.contact || '-'}\nStatus: ${item.status || 'Terdaftar'}\nID: ${item.id}`
      if(confirm(info + '\n\nTekan OK untuk mengajukan klaim (akan diberitahukan ke Admin).')){
        const claimant = prompt('Masukkan nama / kontak Anda untuk klaim (opsional)')
        if(claimant!==null){
          item.claims = item.claims || []
          item.claims.push({at: new Date().toISOString(), by: claimant||'Anon'})
          saveReports(list)
          alert('Klaim telah dicatat. Admin akan diberitahu (demo).')
        }
      }
    }

    form.addEventListener('submit', async (e)=>{
      e.preventDefault()
      const type = document.getElementById('type').value
      const title = document.getElementById('title').value.trim()
      if(!type || !title){return alert('Lengkapi tipe dan judul laporan')}
      const category = document.getElementById('category').value.trim()
      const description = document.getElementById('description').value.trim()
      const location = document.getElementById('location').value.trim()
      const contact = document.getElementById('contact').value.trim()

      const file = document.getElementById('photo').files[0]
      let dataUrl = ''
      if(file){
        if(file.size > 2 * 1024 * 1024){return alert('Ukuran foto melebihi 2MB')}
        try{dataUrl = await fileToDataURL(file)}catch(err){console.warn(err)}
      }

      const list = loadReports()
      const newItem = {id:uid(),type,title,category,description,location,contact,photo:dataUrl || '',status:'terdaftar',created:new Date().toISOString()}
      list.unshift(newItem)
      saveReports(list)
      form.reset()
      alert('Laporan berhasil disimpan (demo).')
    })

    document.getElementById('clearForm').addEventListener('click',()=>form.reset())
    search.addEventListener('input',renderGallery)
    filterType.addEventListener('change',renderGallery)

    // admin overlay controls
    const overlay = document.getElementById('overlay')
    const openAdminBtns = [document.getElementById('openAdmin'), document.getElementById('openAdmin2')].filter(Boolean)
    openAdminBtns.forEach(b=>b && b.addEventListener('click',()=>{overlay.classList.add('show');document.getElementById('adminMsg').textContent=''}))
    document.getElementById('closeOverlay').addEventListener('click',()=>overlay.classList.remove('show'))

    document.getElementById('loginAdmin').addEventListener('click',()=>{
      const pass = document.getElementById('adminPass').value
      const msg = document.getElementById('adminMsg')
      if(pass==='admin'){
        msg.textContent = 'Masuk berhasil (demo)'
        msg.style.color = 'var(--success)'
        setTimeout(()=>{overlay.classList.remove('show'); openAdminPanel()},350)
      }else{msg.textContent = 'Kata sandi salah';msg.style.color='var(--danger)'}
    })

    function openAdminPanel(){
      const list = loadReports()
      if(list.length===0) return alert('Tidak ada laporan untuk dikelola')
      // tampilkan daftar singkat di console dan prompt ubah status
      console.table(list.map(x=>({id:x.id,title:x.title,type:x.type,status:x.status,created:x.created})))
      const id = prompt('Masukkan ID laporan yang ingin diubah (lihat daftar di console)')
      if(!id) return
      const item = list.find(x=>x.id===id)
      if(!item) return alert('ID tidak ditemukan')
      const action = prompt('Pilih aksi: (1) Tandai Terambil (2) Tolak laporan (ketik angka)')
      if(action==='1'){item.status='diambil';saveReports(list);alert('Status diubah: diambil')}
      else if(action==='2'){item.status='ditolak';saveReports(list);alert('Laporan ditolak')}
      else alert('Aksi dibatalkan')
    }

    document.getElementById('listIds').addEventListener('click',()=>{
      const list = loadReports()
      if(list.length===0) return alert('Tidak ada laporan')
      const ids = list.map(x=>`ID: ${x.id} | ${x.title} | ${x.type} | ${x.status}`).join('\n')
      alert('Daftar laporan:\n\n'+ids)
    })

    document.getElementById('btnReset').addEventListener('click',()=>{
      if(confirm('Hapus semua data demo dari browser?')){localStorage.removeItem(STORAGE_KEY);renderGallery();alert('Data demo telah dihapus.')}
    })

    // inisialisasi
    renderGallery()

    // shortcut
    document.addEventListener('keydown',(e)=>{if(e.ctrlKey && e.shiftKey && e.key.toLowerCase()==='a'){openAdminBtns[0] && openAdminBtns[0].click()}})
  </script>
</body>
</html>